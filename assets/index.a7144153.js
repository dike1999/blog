var K=Object.defineProperty,O=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var b=(r,a,l)=>a in r?K(r,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[a]=l,i=(r,a)=>{for(var l in a||(a={}))_.call(a,l)&&b(r,l,a[l]);if(B)for(var l of B(a))M.call(a,l)&&b(r,l,a[l]);return r},x=(r,a)=>O(r,U(a));import{h as Q,i as f,k as u,d as Y,r as g,j as t,b as E,L as c,a as s,s as w,I as G,S as d,B as m,l as H,F as $}from"./index.5e1275c5.js";import{u as J,S as V}from"./useAntdTable.07f5a182.js";import{d as S,P as k}from"./dayjs.6774316b.js";import{u as W}from"./useBreadcrumb.ab4e8c98.js";import"./lodash.93e2b8dd.js";function y(r){const a=document.createElement("a"),l=Q();a.href=l?`${f}${r}?token=${l}`:`${f}${r}`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}const re=()=>{const[r]=u.useForm();W(["\u6587\u7AE0\u7BA1\u7406"]);const{tagList:a,categoryList:l}=Y(e=>({tagList:e.article.tagList,categoryList:e.article.categoryList})),[h,I]=g.exports.useState({}),[p,L]=g.exports.useState(!1),[o,C]=g.exports.useState([]),j=(e,n)=>{const A=n.find(z=>z.name===e);return A&&A.color},T=e=>{y(`/article/output/${e}`)},{tableProps:v,updateList:D,onSearch:F}=J({requestUrl:"/article/list",queryParams:h,columns:[{title:"\u6807\u9898",dataIndex:"title"},{title:"\u6807\u7B7E",dataIndex:"tags",render:e=>e.map(n=>t(E,{color:j(n.name,a),children:t(c,{to:`/tags/${n.name}`,children:n.name})},n.name))},{title:"\u5206\u7C7B",dataIndex:"categories",render:e=>e.map(n=>t(E,{color:"#2db7f5",children:t(c,{to:`/categories/${n.name}`,children:n.name})},n.name))},{title:"\u6D4F\u89C8\u6570",dataIndex:"viewCount",sorter:(e,n)=>n.viewCount-e.viewCount},{title:"\u53D1\u5E03\u65F6\u95F4",dataIndex:"createdAt",sorter:(e,n)=>S(e.createdAt).isBefore(n.createdAt)?1:-1},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"updatedAt",sorter:(e,n)=>S(e.updatedAt).isBefore(n.updatedAt)?1:-1},{dataIndex:"id",title:"\u64CD\u4F5C",render:(e,n)=>s("ul",{className:"action-list",children:[t("li",{children:t(c,{to:`/article/${e}`,children:"\u67E5\u770B"})}),t("li",{children:t(c,{to:{pathname:`/admin/article/edit/${n.id}`,state:{articleId:e}},children:"\u7F16\u8F91"})}),t("li",{children:t("a",{onClick:()=>T(n.id,n.title),children:"\u5BFC\u51FA"})}),t("li",{children:t(k,{title:"Are you sure?",cancelText:"No",onConfirm:()=>D(()=>w.delete(`/article/${e}`)),children:t("a",{className:"delete-text",children:"\u5220\u9664"})})})]})}]}),R=()=>{y(`/article/output/list/${o}`)},P=()=>{y("/article/output/all")},N=()=>{w.delete(`/article/list/${o}`).then(()=>{F(),C([])})},q=p?{selectedRowKeys:o,onChange:e=>C(e)}:null;return s("div",{className:"admin-article-manager",children:[s(u,{form:r,layout:"inline",onFinish:e=>{I(i(i({},h),e)),F(i(i({},h),e))},style:{marginBottom:20},children:[t(u.Item,{label:"\u5173\u952E\u8BCD",name:"keyword",children:t(G,{placeholder:"\u8BF7\u8F93\u5165\u6587\u7AE0\u5173\u952E\u8BCD",allowClear:!0})}),t(u.Item,{label:"\u6807\u7B7E",name:"tag",children:t(d,{style:{width:200},allowClear:!0,children:a.map(e=>t(d.Option,{value:e.name,children:e.name},e.name))})}),t(u.Item,{label:"\u5206\u7C7B",name:"category",children:t(d,{style:{width:200},allowClear:!0,children:l.map(e=>t(d.Option,{value:e.name,children:e.name},e.name))})}),s(u.Item,{children:[t(m,{type:"primary",htmlType:"submit",style:{marginRight:8},children:"\u68C0\u7D22"}),t(m,{type:"primary",onClick:P,style:{marginRight:8},children:"\u5BFC\u51FA\u5168\u90E8\u6587\u7AE0"})]})]}),t(H,x(i({},v),{rowSelection:q,footer:()=>s($,{children:["\u6279\u91CF\u64CD\u4F5C",t(V,{checked:p,onChange:()=>L(e=>!e),style:{marginRight:8}}),p&&s($,{children:[t(m,{type:"primary",size:"small",style:{marginRight:8},disabled:o.length===0,onClick:R,children:"\u5BFC\u51FA\u9009\u4E2D\u9879"}),t(k,{title:"Are you sure delete the articles?",onConfirm:N,okText:"Yes",cancelText:"No",children:t(m,{type:"danger",size:"small",disabled:o.length===0,children:"\u6279\u91CF\u5220\u9664"})})]})]})}))]})};export{re as default};
