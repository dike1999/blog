var ue=Object.defineProperty,de=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var M=(o,a,n)=>a in o?ue(o,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[a]=n,H=(o,a)=>{for(var n in a||(a={}))he.call(a,n)&&M(o,n,a[n]);if(F)for(var n of F(a))ve.call(a,n)&&M(o,n,a[n]);return o},U=(o,a)=>de(o,pe(a));import{at as R,Z as ge,a2 as b,a3 as O,a4 as I,a5 as z,q as k,v as w,an as me,r as d,au as B,y as j,C as V,av as W,aw as xe,ax as Ce,am as ke,ay as ye,az as Te,A as Ne,_ as q,j as v,c as we,ad as Le,u as Ae,s as _e,t as Se,a8 as Ee,ah as Pe,a as y,aa as Re,ab as be,ac as Oe,F as Ie,a9 as ze}from"./index.5e1275c5.js";import{A as De,C as $e,D as Fe}from"./index.aee05186.js";import{u as Me,D as He}from"./index.4ae749b7.js";import"./lodash.93e2b8dd.js";import"./dayjs.6774316b.js";function _(o){return o!==window?o.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function G(o,a,n){if(n!==void 0&&a.top>o.top-n)return n+a.top}function Q(o,a,n){if(n!==void 0&&a.bottom<o.bottom+n){var e=window.innerHeight-a.bottom;return n+e}}var Z=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],L=[];function J(o,a){if(!!o){var n=L.find(function(e){return e.target===o});n?n.affixList.push(a):(n={target:o,affixList:[a],eventHandlers:{}},L.push(n),Z.forEach(function(e){n.eventHandlers[e]=R(o,e,function(){n.affixList.forEach(function(t){t.lazyUpdatePosition()})})}))}}function K(o){var a=L.find(function(n){var e=n.affixList.some(function(t){return t===o});return e&&(n.affixList=n.affixList.filter(function(t){return t!==o})),e});a&&a.affixList.length===0&&(L=L.filter(function(n){return n!==a}),Z.forEach(function(n){var e=a.eventHandlers[n];e&&e.remove&&e.remove()}))}var X=globalThis&&globalThis.__decorate||function(o,a,n,e){var t=arguments.length,i=t<3?a:e===null?e=Object.getOwnPropertyDescriptor(a,n):e,r;if((typeof Reflect=="undefined"?"undefined":ge(Reflect))==="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(o,a,n,e);else for(var s=o.length-1;s>=0;s--)(r=o[s])&&(i=(t<3?r(i):t>3?r(a,n,i):r(a,n))||i);return t>3&&i&&Object.defineProperty(a,n,i),i};function Ue(){return typeof window!="undefined"?window:null}var T;(function(o){o[o.None=0]="None",o[o.Prepare=1]="Prepare"})(T||(T={}));var S=function(o){b(n,o);var a=O(n);function n(){var e;return I(this,n),e=a.apply(this,arguments),e.state={status:T.None,lastAffix:!1,prevTarget:null},e.getOffsetTop=function(){var t=e.props,i=t.offsetBottom,r=t.offsetTop;return i===void 0&&r===void 0?0:r},e.getOffsetBottom=function(){return e.props.offsetBottom},e.savePlaceholderNode=function(t){e.placeholderNode=t},e.saveFixedNode=function(t){e.fixedNode=t},e.measure=function(){var t=e.state,i=t.status,r=t.lastAffix,s=e.props.onChange,c=e.getTargetFunc();if(!(i!==T.Prepare||!e.fixedNode||!e.placeholderNode||!c)){var l=e.getOffsetTop(),f=e.getOffsetBottom(),h=c();if(!!h){var u={status:T.None},g=_(h),p=_(e.placeholderNode),x=G(p,g,l),C=Q(p,g,f);x!==void 0?(u.affixStyle={position:"fixed",top:x,width:p.width,height:p.height},u.placeholderStyle={width:p.width,height:p.height}):C!==void 0&&(u.affixStyle={position:"fixed",bottom:C,width:p.width,height:p.height},u.placeholderStyle={width:p.width,height:p.height}),u.lastAffix=!!u.affixStyle,s&&r!==u.lastAffix&&s(u.lastAffix),e.setState(u)}}},e.prepareMeasure=function(){e.setState({status:T.Prepare,affixStyle:void 0,placeholderStyle:void 0})},e}return z(n,[{key:"getTargetFunc",value:function(){var t=this.context.getTargetContainer,i=this.props.target;return i!==void 0?i:t||Ue}},{key:"componentDidMount",value:function(){var t=this,i=this.getTargetFunc();i&&(this.timeout=setTimeout(function(){J(i(),t),t.updatePosition()}))}},{key:"componentDidUpdate",value:function(t){var i=this.state.prevTarget,r=this.getTargetFunc(),s=(r==null?void 0:r())||null;i!==s&&(K(this),s&&(J(s,this),this.updatePosition()),this.setState({prevTarget:s})),(t.offsetTop!==this.props.offsetTop||t.offsetBottom!==this.props.offsetBottom)&&this.updatePosition(),this.measure()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout),K(this),this.updatePosition.cancel(),this.lazyUpdatePosition.cancel()}},{key:"updatePosition",value:function(){this.prepareMeasure()}},{key:"lazyUpdatePosition",value:function(){var t=this.getTargetFunc(),i=this.state.affixStyle;if(t&&i){var r=this.getOffsetTop(),s=this.getOffsetBottom(),c=t();if(c&&this.placeholderNode){var l=_(c),f=_(this.placeholderNode),h=G(f,l,r),u=Q(f,l,s);if(h!==void 0&&i.top===h||u!==void 0&&i.bottom===u)return}}this.prepareMeasure()}},{key:"render",value:function(){var t=this,i=this.context.getPrefixCls,r=this.state,s=r.affixStyle,c=r.placeholderStyle,l=this.props,f=l.prefixCls,h=l.children,u=k(w({},i("affix",f),!!s)),g=me(this.props,["prefixCls","offsetTop","offsetBottom","target","onChange"]);return d.exports.createElement(B,{onResize:function(){t.updatePosition()}},d.exports.createElement("div",j({},g,{ref:this.savePlaceholderNode}),s&&d.exports.createElement("div",{style:c,"aria-hidden":"true"}),d.exports.createElement("div",{className:u,ref:this.saveFixedNode,style:s},d.exports.createElement(B,{onResize:function(){t.updatePosition()}},h))))}}]),n}(d.exports.Component);S.contextType=V;X([W()],S.prototype,"updatePosition",null);X([W()],S.prototype,"lazyUpdatePosition",null);var Be=S,je=d.exports.createContext(null),Y=je;function Ve(){return window}function ee(o,a){if(!o.getClientRects().length)return 0;var n=o.getBoundingClientRect();return n.width||n.height?a===window?(a=o.ownerDocument.documentElement,n.top-a.clientTop):n.top-a.getBoundingClientRect().top:n.top}var te=/#([\S ]+)$/,E=function(o){b(n,o);var a=O(n);function n(){var e;return I(this,n),e=a.apply(this,arguments),e.state={activeLink:null},e.wrapperRef=d.exports.createRef(),e.links=[],e.registerLink=function(t){e.links.includes(t)||e.links.push(t)},e.unregisterLink=function(t){var i=e.links.indexOf(t);i!==-1&&e.links.splice(i,1)},e.getContainer=function(){var t=e.context.getTargetContainer,i=e.props.getContainer,r=i||t||Ve;return r()},e.handleScrollTo=function(t){var i=e.props,r=i.offsetTop,s=i.targetOffset;e.setCurrentActiveLink(t);var c=e.getContainer(),l=xe(c,!0),f=te.exec(t);if(!!f){var h=document.getElementById(f[1]);if(!!h){var u=ee(h,c),g=l+u;g-=s!==void 0?s:r||0,e.animating=!0,Ce(g,{callback:function(){e.animating=!1},getContainer:e.getContainer})}}},e.saveInkNode=function(t){e.inkNode=t},e.setCurrentActiveLink=function(t){var i=e.state.activeLink,r=e.props,s=r.onChange,c=r.getCurrentAnchor;i!==t&&(e.setState({activeLink:typeof c=="function"?c():t}),s==null||s(t))},e.handleScroll=function(){if(!e.animating){var t=e.props,i=t.offsetTop,r=t.bounds,s=t.targetOffset,c=e.getCurrentAnchor(s!==void 0?s:i||0,r);e.setCurrentActiveLink(c)}},e.updateInk=function(){var t=ke(e),i=t.prefixCls,r=t.wrapperRef,s=r.current,c=s==null?void 0:s.getElementsByClassName("".concat(i,"-link-title-active"))[0];c&&(e.inkNode.style.top="".concat(c.offsetTop+c.clientHeight/2-4.5,"px"))},e}return z(n,[{key:"componentDidMount",value:function(){this.scrollContainer=this.getContainer(),this.scrollEvent=R(this.scrollContainer,"scroll",this.handleScroll),this.handleScroll()}},{key:"componentDidUpdate",value:function(){if(this.scrollEvent){var t=this.getContainer();this.scrollContainer!==t&&(this.scrollContainer=t,this.scrollEvent.remove(),this.scrollEvent=R(this.scrollContainer,"scroll",this.handleScroll),this.handleScroll())}this.updateInk()}},{key:"componentWillUnmount",value:function(){this.scrollEvent&&this.scrollEvent.remove()}},{key:"getCurrentAnchor",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,r=[],s=this.getContainer();if(this.links.forEach(function(l){var f=te.exec(l.toString());if(!!f){var h=document.getElementById(f[1]);if(h){var u=ee(h,s);u<t+i&&r.push({link:l,top:u})}}}),r.length){var c=r.reduce(function(l,f){return f.top>l.top?f:l});return c.link}return""}},{key:"render",value:function(){var t=this,i=this.context,r=i.getPrefixCls,s=i.direction,c=this.props,l=c.prefixCls,f=c.className,h=f===void 0?"":f,u=c.style,g=c.offsetTop,p=c.affix,x=c.showInkInFixed,C=c.children,P=c.onClick,N=this.state.activeLink,m=r("anchor",l);this.prefixCls=m;var A=k("".concat(m,"-ink-ball"),{visible:N}),ae=k("".concat(m,"-wrapper"),w({},"".concat(m,"-rtl"),s==="rtl"),h),oe=k(m,w({},"".concat(m,"-fixed"),!p&&!x)),se=j({maxHeight:g?"calc(100vh - ".concat(g,"px)"):"100vh"},u),$=d.exports.createElement("div",{ref:this.wrapperRef,className:ae,style:se},d.exports.createElement("div",{className:oe},d.exports.createElement("div",{className:"".concat(m,"-ink")},d.exports.createElement("span",{className:A,ref:this.saveInkNode})),C)),ce=ye(function(le,fe){return{registerLink:t.registerLink,unregisterLink:t.unregisterLink,scrollTo:t.handleScrollTo,activeLink:le,onClick:fe}})(N,P);return d.exports.createElement(Y.Provider,{value:ce},p?d.exports.createElement(Be,{offsetTop:g,target:this.getContainer},$):$)}}]),n}(d.exports.Component);E.defaultProps={affix:!0,showInkInFixed:!1};E.contextType=V;var D=function(o){b(n,o);var a=O(n);function n(){var e;return I(this,n),e=a.apply(this,arguments),e.handleClick=function(t){var i=e.context,r=i.scrollTo,s=i.onClick,c=e.props,l=c.href,f=c.title;s==null||s(t,{title:f,href:l}),r(l)},e.renderAnchorLink=function(t){var i=t.getPrefixCls,r=e.props,s=r.prefixCls,c=r.href,l=r.title,f=r.children,h=r.className,u=r.target,g=i("anchor",s),p=e.context.activeLink===c,x=k("".concat(g,"-link"),w({},"".concat(g,"-link-active"),p),h),C=k("".concat(g,"-link-title"),w({},"".concat(g,"-link-title-active"),p));return d.exports.createElement("div",{className:x},d.exports.createElement("a",{className:C,href:c,title:typeof l=="string"?l:"",target:u,onClick:e.handleClick},l),f)},e}return z(n,[{key:"componentDidMount",value:function(){this.context.registerLink(this.props.href)}},{key:"componentDidUpdate",value:function(t){var i=t.href,r=this.props.href;i!==r&&(this.context.unregisterLink(i),this.context.registerLink(r))}},{key:"componentWillUnmount",value:function(){this.context.unregisterLink(this.props.href)}},{key:"render",value:function(){return d.exports.createElement(Te,null,this.renderAnchorLink)}}]),n}(d.exports.Component);D.defaultProps={href:"#"};D.contextType=Y;var We=D;E.Link=We;var ne=E,qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 161H699.2c-49.1 0-97.1 14.1-138.4 40.7L512 233l-48.8-31.3A255.2 255.2 0 00324.8 161H96c-17.7 0-32 14.3-32 32v568c0 17.7 14.3 32 32 32h228.8c49.1 0 97.1 14.1 138.4 40.7l44.4 28.6c1.3.8 2.8 1.3 4.3 1.3s3-.4 4.3-1.3l44.4-28.6C602 807.1 650.1 793 699.2 793H928c17.7 0 32-14.3 32-32V193c0-17.7-14.3-32-32-32zM324.8 721H136V233h188.8c35.4 0 69.8 10.1 99.5 29.2l48.8 31.3 6.9 4.5v462c-47.6-25.6-100.8-39-155.2-39zm563.2 0H699.2c-54.4 0-107.6 13.4-155.2 39V298l6.9-4.5 48.8-31.3c29.7-19.1 64.1-29.2 99.5-29.2H888v488zM396.9 361H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm223.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c0-4.1-3.2-7.5-7.1-7.5H627.1c-3.9 0-7.1 3.4-7.1 7.5zM396.9 501H211.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5zm416 0H627.1c-3.9 0-7.1 3.4-7.1 7.5v45c0 4.1 3.2 7.5 7.1 7.5h185.7c3.9 0 7.1-3.4 7.1-7.5v-45c.1-4.1-3.1-7.5-7-7.5z"}}]},name:"read",theme:"outlined"},Ge=qe,ie=function(a,n){return d.exports.createElement(Ne,q(q({},a),{},{ref:n,icon:Ge}))};ie.displayName="ReadOutlined";var Qe=d.exports.forwardRef(ie);const{Link:Ze}=ne,Je=o=>{const a=/<(h[1-6])[\s\S]+?(?=<\/\1>)/g,n=[],e=(t,i)=>{const r=t.length,s=t[r-1];s&&s.tag!==i.tag?e(s.children,i):t.push(i)};return o.replace(a,(t,i)=>{const r=t.replace(/.*?>/,""),s=t.indexOf('"'),c=t.indexOf('">'),l=`#${t.slice(s+1,c)}`;e(n,{tag:i,title:r,href:l,children:[]})}),n},re=({content:o})=>{const a=Je(o),n=({href:e,title:t,children:i})=>v(Ze,{href:e,title:t,children:i.length>0&&i.map(r=>n(r))},e);return v(ne,{affix:!1,children:a.map(n)})};const it=()=>{const o=we(),a=Le(),n=Ae(),[e,t]=Me(),[i,r]=d.exports.useState({title:"",content:"",tags:[],categories:[],comments:[],createdAt:"",viewCount:0}),[s,c]=d.exports.useState(!1);d.exports.useEffect(()=>{setTimeout(()=>{const m=decodeURI(a.hash),A=document.querySelector(`a[href="${m}"]`);A&&m&&A.click()},800)},[]),d.exports.useEffect(()=>{t(_e.get(`/article/${n.id}`)).then(m=>{m.content=Se(m.content),r(m)}).catch(()=>{o("/404")})},[n.id]);const l=m=>{r(U(H({},i),{comments:m}))},{title:f,content:h,tags:u,categories:g,comments:p,createdAt:x,viewCount:C}=i,P=parseInt(n.id,10),N=Ee.exports.useMediaQuery({query:"(max-width: 1300px)"});return v(Pe,{tip:"Loading...",spinning:e,children:y("article",{className:"app-article",style:{paddingRight:N?0:275},children:[y("div",{className:"post-header",children:[v("h1",{className:"post-title",children:f}),y("div",{className:"article-desc",children:[y("span",{className:"post-time",children:[v(Qe,{}),"\xA0 Posted on \xA0",v("span",{children:x.slice(0,10)})]}),v(De,{tagList:u,categoryList:g}),v(Re,{type:"vertical"}),y("a",{className:"comment-count",href:"#discuss",style:{color:"inherit"},children:[v($e,{style:{marginRight:2}}),v("span",{style:{marginRight:5},children:be(p)})]}),v(Oe,{style:{marginRight:2}}),v("span",{children:C})]})]}),v("div",{className:"article-detail",dangerouslySetInnerHTML:{__html:h}}),N?y(Ie,{children:[v("div",{className:"drawer-btn",onClick:()=>c(!0),children:v(ze,{className:"nav-phone-icon"})}),v(Fe,{title:f,placement:"right",closable:!1,onClose:()=>c(!1),visible:s,getContainer:()=>document.querySelector(".app-article"),children:v("div",{className:"right-navigation",children:v(re,{content:h})})})]}):v("nav",{className:"article-navigation",children:v(re,{content:h})}),v(He,{articleId:P,commentList:p,setCommentList:l})]})})};export{it as default};
